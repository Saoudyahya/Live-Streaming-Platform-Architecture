# Low Latency SRS Configuration
listen              1935;
max_connections     1000;
daemon              off;
srs_log_tank        console;
srs_log_level       info;  # Reduced from trace for performance

http_server {
    enabled         on;
    listen          8080;
    dir             /usr/local/srs/objs/nginx/html;
    crossdomain     on;
}

http_api {
    enabled         on;
    listen          1985;
    crossdomain     on;
}

vhost __defaultVhost__ {
    # Low latency HLS settings
    hls {
        enabled         on;
        hls_path        /usr/local/srs/objs/nginx/html/live;
        hls_fragment    1;      # 1 second segments (was 2)
        hls_window      3;      # 3 segments in playlist (was 6)
        hls_m3u8_file   [stream].m3u8;  # Direct file, no [app] folder
        hls_ts_file     [stream]-[seq].ts;
        hls_cleanup     on;
        hls_dispose     10;     # Clean up faster
    }

    # Optional: Add DVR for debugging
    dvr {
        enabled         off;
    }

    # Optimize for low latency
    tcp_nodelay     on;
    min_latency     on;

    # Reduce GOP size for lower latency (if you control the encoder)
    refer           github.com/ossrs/srs/wiki/v4_EN_LowLatency;
}